---
title: gitlab benchmark
date: 2020-01-08 17:53:37
tags:
---

### 压测目标

针对单节点部署的gitlab服务器进行压测，探查单机服务器的并发能力上限。

### 压测场景

针对最常用的web接口、git-shell操作两部分进行测试。

web端使用h2load工具对，测试接口如下

| 接口   | 并发数 | 平响时间 | QPS  |
| ------ | ------ | -------- | ---- |
| 首页   |        |          |      |
| 项目页 |        |          |      |
| 配置页 |        |          |      |

**重点**：ssh操作使用并发脚本，测试接口如下

| 操作          | 仓库数量 | 仓库文件数量与大小 |
| ------------- | -------- | ------------------ |
| git clone     |          |                    |
| git pull      |          |                    |
| git push      |          |                    |
| git merge     |          |                    |
| git branch    |          |                    |
| git branch -d |          |                    |

**注**: 压测环境使用gitlab测试环境，官方建议的服务配置，最好配有CI/CD。

### 监测指标
| 操作          | 仓库数量 | 仓库文件数量与大小 | 并发数 | 平响时间 |
| ------------- | -------- | ------------------ | ------ | -------- |
| git clone     |          |                    |        |          |
| git pull      |          |                    |        |          |
| git push      |          |                    |        |          |
| git merge     |          |                    |        |          |
| git branch    |          |                    |        |          |
| git branch -d |          |                    |        |          |

最终取平响时间为2s（用户最满意的网页打开速度）的并发数作为最终结果。



**TO-DO**

1. 脚本编写
2. 监控，瓶颈定位